<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rooms</title>

    <link rel="icon" 
      type="image/png" 
      href="/favicon.ico">

    <style>
        #inputMessage {
            display: block;
            position: fixed;
            left: 50%;
            bottom: 0;
            transform: translate(-50%, 0%);
            margin: 0 auto;
            background-color: aqua;
            padding-bottom: 20px;
            padding-top: 20px;
            padding-left: 20px;
            padding-right: 20px;
        }
    </style>
</head>
<body style="background-color: black;">
    <div style="color: antiquewhite; font-size: 200%; text-align: center; word-wrap: break-word;" id="chat">
    </div>

    <br>
    <br>
    <br>
    <br>
    <br>
    <br>


    <footer>
        <div id="inputMessage">
            <form id = "fo" onsubmit="clicked(); return false">
                <input type="text" id="inp" onsubmit="clicked()"> 
                <input type="button" onclick="clicked()" value="SUBMIT">   
            </form>
            
        </div>
    </footer>
</body>
</html>

<script>

    function dispMessages(message){
        var te = document.getElementById("chat")

        te.innerText += message.author + " : " +message.data
        te.innerHTML += "<br><br>"

        
    }

    const userID = Math.round(Math.random() * 8191)

    const socket = new WebSocket("ws://"+window.location.hostname+":443")

    socket.addEventListener("message", function(event){
        
        UnCompressed = JSON.parse(event.data)

        window.scrollTo(0, document.body.scrollHeight);

        dispMessages(UnCompressed)
    })

    function clicked(){
        socket.send(JSON.stringify( new Message(document.getElementById("inp").value, userID, 0, 0)))
        document.getElementById("inp").value = ""
    }

    class Message { 
        data

        author

        room

        date 

        constructor (tData, tAuthor, tRoom, tDate){
            this.data = tData
            this.author = tAuthor
            this.room = tRoom
            this.date = tDate
        }
    }   

    ""
</script>